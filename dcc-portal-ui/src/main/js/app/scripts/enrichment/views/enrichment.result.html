<div data-ng-if="item.state === 'EXECUTING'">
    <h1 class="text-center"><i class="icon-spinner icon-spin" style="font-size:5rem"></i></h1>
</div>
<div data-ng-if="item.state === 'FINISHED'">
    <div>
        <h4>Overview</h4>
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>Universe</th>
                    <th class="text-right"># Gene set in Universe</th>
                    <th class="text-right"># Gene set in overlap</th>
                    <th class="text-right"># Genes in Universe</th>
                    <th class="text-right"># Genes in overlap</th>
                    <th class="text-right"># Input genes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>{{item.params.universe}}</td>
                    <td class="text-right">{{item.overview.universeGeneSetCount | number}}</td>
                    <td class="text-right">{{item.overview.overlapGeneSetCount | number}}</td>
                    <td class="text-right">{{item.overview.universeGeneCount | number}}</td>
                    <td class="text-right">{{item.overview.overlapGeneCount | number}}</td>
                    <td class="text-right">{{item.params.maxGeneCount | number}}</td>
                </tr>
            </tbody>
        </table>
        <br>

        <h4>Original Query:</h4>
        <div>
            <a href="/search?filters={{item.query.filters}}">
                <span>
                    <query-display data-filters="item.query.filters"></query-display>
                </span>
            </a>
        </div>
        <br>


        <h4>
            <span data-ng-if="item.params.maxGeneCount <= item.overview.universeGeneCount">
                Top <strong>{{item.params.maxGeneSetCount | number}}</strong> gene sets out of <strong>{{item.overview.universeGeneSetCount | number}}</strong> enriched gene sets with FDR &le; <strong>{{item.params.fdr}}</strong>
            </span>

            <span data-ng-if="item.params.maxGeneCount > item.overview.universeGeneCount">
                {{item.overview.universeGeneSetCount | number}} enriched gene sets with FDR &lt;= {{item.params.fdr}}
            </span>

            <span class="t_tools">
                <span class="t_tools__tool"
                      data-tooltip-placement="left"
                      data-tooltip="Export Table as CSV"
                      data-ng-click="exportEnrichment(item.id)"><i class="icon-file"></i></span>
            </span>
        </h4>


        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Name</th>
                    <th># Genes</th>
                    <th># Genes in overlap</th>
                    <th># Donors affected</th>
                    <th># Mutations</th>
                    <th>Expected</th>
                    <th style="cursor: pointer"
                        data-ng-click="predicate='pvalue'; reverse=!reverse">P-Value
                        <i style="color:hsl(0,0%,80%)" data-ng-if="predicate!='pvalue'" class="icon-sort"></i>
                        <i data-ng-if="predicate=='pvalue'&& !reverse" class="icon-sort-up"></i>
                        <i data-ng-if="predicate=='pvalue'&& reverse" class="icon-sort-down"></i>
                    </th>
                    <th style="cursor: pointer"
                        data-ng-click="predicate='adjustedPValue'; reverse=!reverse">Adjusted P-Value
                        <i style="color:hsl(0,0%,80%)" data-ng-if="predicate!='adjustedPValue'" class="icon-sort"></i>
                        <i data-ng-if="predicate=='adjustedPValue'&&!reverse" class="icon-sort-up"></i>
                        <i data-ng-if="predicate=='adjustedPValue'&&reverse" class="icon-sort-down"></i>
                    </th>
                </tr>
            </thead>
            <tbody>
                <tr data-ng-repeat="row in item.results | orderBy:predicate:reverse">
                    <td><a data-ng-href="/genesets/{{row.geneSetId}}">{{row.geneSetId}}</a></td>
                    <td>{{row.geneSetName}}</td>
                    <td class="text-right">{{row.geneCount | number}}</td>
                    <td class="text-right">{{row.overlapGeneSetGeneCount | number}}</td>
                    <td class="text-right">{{row.overlapGeneSetDonorCount | number}}</td>
                    <td class="text-right">{{row.overlapGeneSetMutationCount | number}}</td>
                    <td class="text-right">{{row.expectedValue.toExponential(2) }}</td>
                    <td class="text-right">{{row.pvalue.toExponential(2) }}</td>
                    <td class="text-right">{{row.adjustedPValue.toExponential(2) }}</td>
                </tr>
            </tbody>
        </table>
        <br>
        <span>
            Documentation for Enrichment analysis is available on this link: 
            <a href="">Enrichment Analysis Documentation</a>
        </span>
    </div>
</div>
