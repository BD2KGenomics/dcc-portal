<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - app/scripts/ui/directives.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome-ie7.css" rel="stylesheet">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet">
  <link href="../../assets/css/plato.css" rel="stylesheet">
  <link href="../../assets/css/plato-file.css" rel="stylesheet">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="http://github.com/es-analysis/plato">Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>app/scripts/ui/directives.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">69.47</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">792</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">71.40</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">8.43</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">/*
 * Copyright 2013(c) The Ontario Institute for Cancer Research. All rights reserved.
 *
 * This program and the accompanying materials are made available under the terms of the GNU Public
 * License v3.0. You should have received a copy of the GNU General Public License along with this
 * program. If not, see &lt;http://www.gnu.org/licenses/&gt;.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR
 * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
 * FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR
 * CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
 * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY
 * WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

&#039;use strict&#039;;

angular.module(&#039;icgc.ui&#039;, [&#039;icgc.ui.suggest&#039;, &#039;icgc.ui.table&#039;, &#039;icgc.ui.tooltip&#039;, &#039;icgc.ui.toolbar&#039;, &#039;icgc.ui.openin&#039;]);

angular.module(&#039;app.ui&#039;, [
  &#039;app.ui.sortable&#039;,
  &#039;app.ui.scrollto&#039;,
  &#039;app.ui.pagination&#039;,
  &#039;app.ui.tpls&#039;, &#039;app.ui.aachange&#039;,
  &#039;app.ui.synonyms&#039;,
//  &#039;app.ui.dl&#039;,
  &#039;app.ui.scrolled&#039;, &#039;app.ui.focus&#039;, &#039;app.ui.blur&#039;,
  &#039;app.ui.param&#039;, &#039;app.ui.nested&#039;, &#039;app.ui.mutation&#039;, &#039;app.ui.hidetext&#039;, &#039;app.ui.lists&#039;,
  &#039;app.ui.es&#039;, &#039;app.ui.exists&#039;, &#039;app.ui.scrollSpy&#039;
]);

angular.module(&#039;app.ui.exists&#039;, []).directive(&#039;exists&#039;, function () {
  return {
    restrict: &#039;A&#039;,
    replace: true,
    scope: {
      exists: &#039;=&#039;
    },
    template: &#039;&lt;span&gt;&lt;i data-ng-if=&quot;exists&quot; class=&quot;icon-ok&quot;&gt;&lt;/i&gt;&lt;span data-ng-if=&quot;!exists&quot;&gt;--&lt;/span&gt;&lt;/span&gt;&#039;
  };
});

angular.module(&#039;app.ui.es&#039;, []).directive(&#039;expandSearch&#039;, function () {
  return {
    restrict: &#039;A&#039;,
    replace: true,
    transclude: true,
    template: &#039;&lt;a ng-class=&quot;{\&#039;open\&#039;:o.open==true}&quot; ng-transclude=&quot;&quot;&gt;&lt;/a&gt;&#039;,
    link: function (scope, elem) {
      scope.o = {};
      scope.expand = function () {
        scope.o.open = true;
        jQuery(elem).find(&#039;input&#039;).focus();
      };
    }
  };
});

angular.module(&#039;app.ui.lists&#039;, []).directive(&#039;hideSumList&#039;, function (Projects) {
  return {
    restrict: &#039;A&#039;,
    //replace: true,
    transclude: true,
    template: &#039;&lt;div class=&quot;t_sh&quot;&gt;&#039; +
        &#039;&lt;span data-ng-if=&quot;!hasItems&quot;&gt;&lt;i class=&quot;icon-spin icon-spinner&quot;&gt;&lt;/i&gt;&lt;/span&gt;&#039; +
        &#039;&lt;span data-ng-if=&quot;!show&amp;&amp;hasItems&quot;&gt;--&lt;/span&gt;&#039; +
        &#039;&lt;div data-ng-if=&quot;show&quot; class=&quot;text-right&quot;&gt;&#039; +
        &#039;&lt;a href=&quot;{{ link }}&quot;&gt;{{sum}}&lt;/a&gt;&#039; +
        &#039; / &#039; +
        &#039;&lt;a href=\&#039;/search?filters={&quot;donor&quot;:{&quot;availableDataTypes&quot;:{&quot;is&quot;:[&quot;ssm&quot;]}}}\&#039;&gt;{{sumTotal}}&lt;/a&gt;&#039; +
        &#039; &lt;em&gt;({{sum/sumTotal*100|number:2}}%)&lt;/em&gt;&#039; +
        &#039;&lt;span data-ng-click=&quot;toggle()&quot; class=&quot;t_tools__tool&quot;&gt;&#039; +
        &#039;&lt;i data-ng-class=&quot;expanded ? \&#039;icon-caret-down\&#039; : \&#039;icon-caret-left\&#039;&quot;&gt;&lt;/i&gt;&#039; +
        &#039;&lt;/span&gt;&#039; +
        &#039;&lt;/div&gt;&#039; +
        &#039;&lt;div data-ng-transclude&gt;&lt;/div&gt;&#039; +
        &#039;&lt;/div&gt;&#039;,
    link: function (scope, elem, attrs) {
      var previous, next, limit;

      scope.hasItems = false;
      // How many items to show in collapsed list
      limit = attrs.limit ? parseInt(attrs.limit, 10) : 0;

      function swap() {
        previous = [next, next = previous][0];
      }

      function list(value) {
        scope.hasItems = true;
        scope.list = value;
        // How many items are hidden
        scope.more = scope.list.length - limit;
        // If there is more than 1 item in the collapsed list show toggle
        scope.show = scope.more &gt; 0;

        previous = scope.list;
        next = scope.show ? scope.list.slice(0, limit) : scope.list;

        // If list updates while expanded
        if (scope.expanded) {
          swap();
        }

        scope.list = next;

        scope.sum = _.reduce(_.pluck(value, &#039;count&#039;), function (s, n) {
          return s + n;
        });

        scope.sumTotal = Projects.totalSsmTestedDonorCount;
      }

      scope.toggle = function () {
        scope.expanded = !scope.expanded;
        swap();
        scope.list = next;
      };

      // Need to use observe instead of scope so list still
      // has access to parent scope events
      attrs.$observe(&#039;hideSumList&#039;, function (value) {
        if (value) {
          list(angular.fromJson(value));
        }
      });

      attrs.$observe(&#039;sum&#039;, function (value) {
        if (value) {
          scope.sum = angular.fromJson(value);
        }
      });

      attrs.$observe(&#039;link&#039;, function (value) {
        if (value) {
          scope.link = value;
        }
      });
    }
  };
});

angular.module(&#039;app.ui.lists&#039;).directive(&#039;hideLinkList&#039;, function () {
  return {
    restrict: &#039;A&#039;,
    //replace: true,
    transclude: true,
    template: &#039;&lt;div class=&quot;t_sh&quot;&gt;&#039; +
        &#039;&lt;span data-ng-if=&quot;!hasItems&quot;&gt;&lt;i class=&quot;icon-spin&quot;&gt;&lt;/i&gt;&lt;/span&gt;&#039; +
        &#039;&lt;span data-ng-if=&quot;!show&amp;&amp;hasItems&quot;&gt;--&lt;/span&gt;&#039; +
        &#039;&lt;div data-ng-if=&quot;show&quot; class=&quot;text-right&quot;&gt;&#039; +
        &#039;&lt;a data-ng-href=&quot;{{ link }}&quot;&gt;{{ more }}&lt;/a&gt; &#039; +
        &#039;&lt;span data-ng-if=&quot;!expanded&quot;&gt;&#039; +
        &#039;&lt;span data-ng-click=&quot;toggle()&quot; class=&quot;t_tools__tool&quot;&gt;&lt;i class=&quot;icon-caret-left&quot;&gt;&lt;/i&gt;&lt;/span&gt;&#039; +
        &#039;&lt;/span&gt;&#039; +
        &#039;&lt;span data-ng-if=&quot;expanded&quot; data-ng-click=&quot;toggle()&quot; class=&quot;t_tools__tool&quot;&gt;&lt;i class=&quot;icon-caret-down&quot;&gt;&lt;/i&gt;&lt;/span&gt;&#039; +
        &#039;&lt;/div&gt;&#039; +
        &#039;&lt;div data-ng-transclude&gt;&lt;/div&gt;&#039; +
        &#039;&lt;/div&gt;&#039;,
    link: function (scope, elem, attrs) {
      var previous, next, limit;

      scope.hasItems = false;
      // How many items to show in collapsed list
      limit = attrs.limit ? parseInt(attrs.limit, 10) : 0;

      function swap() {
        previous = [next, next = previous][0];
      }

      function list(value) {
        scope.hasItems = true;
        scope.list = value;
        // How many items are hidden
        scope.more = scope.list.length - limit;
        // If there is more than 1 item in the collapsed list show toggle
        scope.show = scope.more &gt; 0;

        previous = scope.list;
        next = scope.show ? scope.list.slice(0, limit) : scope.list;

        // If list updates while expanded
        if (scope.expanded) {
          swap();
        }

        scope.list = next;
      }

      scope.toggle = function () {
        scope.expanded = !scope.expanded;
        swap();
        scope.list = next;
      };

      // Need to use observe instead of scope so list still
      // has access to parent scope events
      attrs.$observe(&#039;hideLinkList&#039;, function (value) {
        if (value) {
          list(JSON.parse(value));
        }
      });

      attrs.$observe(&#039;link&#039;, function (value) {
        if (value) {
          scope.link = value;
        }
      });
    }
  };
});

angular.module(&#039;app.ui.lists&#039;).directive(&#039;hideList&#039;, function () {
  return {
    restrict: &#039;A&#039;,
    replace: true,
    transclude: true,
    template: &#039;&lt;ul class=&quot;t_sh&quot;&gt;&#039; +
        &#039;&lt;li data-ng-if=&quot;list.length == 0&quot;&gt;--&lt;/li&gt;&#039; +
        &#039;&lt;li&gt;&lt;ul ng-transclude&gt;&lt;/ul&gt;&lt;/li&gt;&#039; +
        &#039;&lt;li ng-if=&quot;show&quot; class=&quot;t_sh__toggle&quot;&gt;&#039; +
        &#039;&lt;a ng-click=&quot;toggle()&quot; href=&quot;&quot; class=&quot;t_tools__tool&quot;&gt;&#039; +
        &#039;&lt;span ng-if=&quot;!expanded&quot;&gt;&lt;i class=&quot;icon-caret-down&quot;&gt;&lt;/i&gt; {{ more }} more&lt;/span&gt;&#039; +
        &#039;&lt;span ng-if=&quot;expanded&quot;&gt;&lt;i class=&quot;icon-caret-up&quot;&gt;&lt;/i&gt; less&lt;/span&gt;&#039; +
        &#039;&lt;/a&gt;&#039; +
        &#039;&lt;/li&gt;&lt;/ul&gt;&#039;,
    link: function (scope, elem, attrs) {
      var previous, next, limit;

      // How many items to show in collapsed list
      limit = attrs.limit ? parseInt(attrs.limit, 10) : 1;

      function swap() {
        previous = [next, next = previous][0];
      }

      function list(value) {
        scope.list = value;
        // How many items are hidden
        scope.more = scope.list.length - limit;
        // If there is more than 1 item in the collapsed list show toggle
        scope.show = scope.more &gt; 1;

        previous = scope.list;
        next = scope.show ? scope.list.slice(0, limit) : scope.list;

        // If list updates while expanded
        if (scope.expanded) {
          swap();
        }

        scope.list = next;
      }

      scope.toggle = function () {
        scope.expanded = !scope.expanded;
        swap();
        scope.list = next;
      };

      // Need to use observe instead of scope so list still
      // has access to parent scope events
      attrs.$observe(&#039;hideList&#039;, function (value) {
        if (value) {
          list(JSON.parse(value));
        }
      });
    }
  };
});

angular.module(&#039;app.ui.hidetext&#039;, []).directive(&#039;hideText&#039;, function () {
  return {
    restrict: &#039;E&#039;,
    replace: true,
    transclude: true,
    template: &#039;&lt;div class=&quot;t_sh&quot;&gt;&#039; +
        &#039;{{ text }}&#039; +
        &#039;&lt;div ng-if=&quot;text.length&gt;=limit&quot; class=&quot;t_sh__toggle&quot; ng-click=&quot;toggle()&quot;&gt;&#039; +
        &#039;&lt;a href=&quot;&quot; class=&quot;t_tools__tool&quot; ng-if=&quot;!expanded&quot;&gt;&lt;i class=&quot;icon-caret-down&quot;&gt;&lt;/i&gt; more&lt;/a&gt;&#039; +
        &#039;&lt;a href=&quot;&quot; class=&quot;t_tools__tool&quot; ng-if=&quot;expanded&quot;&gt;&lt;i class=&quot;icon-caret-up&quot;&gt;&lt;/i&gt; less&lt;/a&gt;&#039; +
        &#039;&lt;/div&gt;&#039; +
        &#039;&lt;/div&gt;&#039;,
    link: function (scope, element, attrs) {
      var previous, next;

      scope.limit = 200;

      previous = attrs.text;
      next = attrs.text.length &gt; scope.limit ? attrs.text.slice(0, scope.limit) + &#039;...&#039; : attrs.text;
      scope.text = next;

      scope.toggle = function () {
        scope.expanded = !scope.expanded;
        previous = [next, next = previous][0];
        scope.text = next;
      };
    }
  };
});

angular.module(&#039;app.ui.nested&#039;, []).directive(&#039;nested&#039;, function ($location) {
  return function (scope, element, attrs) {
    element.bind(&#039;click&#039;, function (e) {
      e.preventDefault();
      scope.$apply(function () {
        $location.path(attrs.href);
      });
    });
  };
});

angular.module(&#039;app.ui.mutation&#039;, []).directive(&#039;mutationConsequences&#039;, function ($filter, ConsequenceOrder) {
  return {
    restrict: &#039;E&#039;,
    scope: {
      items: &#039;=&#039;
    },
    template: &#039;&lt;ul class=&quot;unstyled&quot;&gt;&#039; +
        &#039;&lt;li data-ng-repeat=&quot;c in consequences&quot;&gt;&#039; +
        &#039;&lt;abbr data-tooltip=&quot;{{ c.consequence | trans | define }}&quot;&gt;{{c.consequence | trans}}&lt;/abbr&gt;&#039; +
        &#039;&lt;span data-ng-repeat=&quot;(gk, gv) in c.data&quot;&gt;&#039; +
        &#039;&lt;span data-ng-if=&quot;$first == true&quot;&gt;: &lt;/span&gt;&#039; +
        &#039;&lt;a href=&quot;/genes/{{gk}}&quot;&gt;&lt;em&gt;{{gv.symbol}}&lt;/em&gt;&lt;/a&gt; &#039; +
        &#039;{{(gv.aaChangeList | unique).join(\&#039;, \&#039;)}}&#039; +
        &#039;&lt;span data-ng-if=&quot;$last != true&quot;&gt; - &lt;/span&gt;&#039; +
        &#039;&lt;/span&gt;&#039; +
        &#039;&lt;span class=&quot;hidden&quot; data-ng-if=&quot;$last != true&quot;&gt;|&lt;/span&gt;&#039; + // Separator for html download
        &#039;&lt;/li&gt;&#039; +
        &#039;&lt;/ul&gt;&#039;,
    link: function (scope) {
      var consequenceMap;

      // Massage the tabular data into the following format:
      // Consequence1: gene1 [aa1 aa2] - gene2 [aa1 aa2] - gene3 [aa3 aa4]
      // Consequence2: gene1 [aa1 aa2] - gene5 [aa1 aa2]
      consequenceMap = {};
      scope.items.forEach(function (consequence) {
        var geneId, type;

        geneId = consequence.geneAffectedId;
        type = consequence.type;

        if (geneId) {
          if (!consequenceMap.hasOwnProperty(type)) {
            consequenceMap[type] = {};
          }

          var c = consequenceMap[type];
          if (!c.hasOwnProperty(geneId)) {
            c[geneId] = {};
            c[geneId].symbol = consequence.geneAffectedSymbol;
            c[geneId].id = geneId;
            c[geneId].aaChangeList = [];
          }
          c[geneId].aaChangeList.push(consequence.aaMutation);
        }

      });

      // Dump into a list, easier to format/sort
      scope.consequences = [];
      for (var k in consequenceMap) {
        if (consequenceMap.hasOwnProperty(k)) {
          scope.consequences.push({
            consequence: k,
            data: consequenceMap[k]
          });
        }
      }

      scope.consequences = $filter(&#039;orderBy&#039;)(scope.consequences, function (t) {
        var index = ConsequenceOrder.indexOf(t.consequence);
        if (index === -1) {
          return ConsequenceOrder.length + 1;
        }
        return index;
      });
    }
  };
});

angular.module(&#039;app.ui.param&#039;, []).directive(&#039;param&#039;, function (LocationService) {
  return {
    restrict: &#039;A&#039;,
    transclude: true,
    replace: true,
    scope: {
      key: &#039;@&#039;,
      value: &#039;@&#039;,
      defaultSelect: &#039;@&#039;
    },
    template: &#039;&lt;span data-ng-class=&quot;{\&#039;t_labels__label_inactive\&#039;: !active}&quot; data-ng-click=&quot;update()&quot;&gt;&#039; +
        &#039;&lt;i data-ng-class=&quot;{\&#039;icon-ok\&#039;: active}&quot;&gt;&lt;/i&gt; {{value | trans:true}}&lt;/span&gt;&#039;,
    link: function (scope) {
      var type = LocationService.search()[scope.key];

      if (type) {
        scope.active = type === scope.value;
      } else {
        scope.active = !!scope.defaultSelect;
      }

      scope.update = function () {
        LocationService.setParam(scope.key, scope.value);
      };

      scope.$watch(function () {
        return LocationService.search()[scope.key];
      }, function (n) {
        if (n) {
          scope.active = n === scope.value;
        } else {
          scope.active = !!scope.defaultSelect;
        }
      }, true);
    }
  };
});

angular.module(&#039;app.ui.focus&#039;, []).directive(&#039;focus&#039;, function ($parse) {
  return function (scope, element, attr) {
    var fn = $parse(attr.focus);

    function callback(event) {
      scope.$apply(function () {
        fn(scope, {$event: event});
      });
    }

    element.on(&#039;focus&#039;, callback);
  };
});

angular.module(&#039;app.ui.blur&#039;, []).directive(&#039;blur&#039;, function ($parse) {
  return function (scope, element, attr) {
    var fn = $parse(attr.blur);

    function callback(event) {
      scope.$apply(function () {
        fn(scope, {$event: event});
      });
    }

    element.on(&#039;blur&#039;, callback);
  };
});

angular.module(&#039;app.ui.scrolled&#039;, []).directive(&#039;scrolled&#039;, function ($window) {
  return function (scope, elem) {
    var w, oy;

    w = angular.element($window);
    oy = w.scrollTop();

    function checkDelta() {
      var top = w.scrollTop();

      // only scroll down after top 100px
      // only scroll if d &gt; 50px
      if (top &gt; 150 &amp;&amp; top &gt; oy + 50) {
        //scroll down
        elem.stop(true, true).animate({
          top: &#039;-51&#039;
        }, 100);
        oy = top;
      } else if (top &lt; oy - 50) {
        //scroll up
        elem.stop(true, true).animate({
          top: &#039;0&#039;
        }, 100);
        oy = top;
      }
    }

    w.on(&#039;scroll&#039;, checkDelta);
    scope.$on(&#039;$destroy&#039;, function () {
      w.off(&#039;scroll&#039;, checkDelta);
    });
  };
});

angular.module(&#039;app.ui.synonyms&#039;, []).directive(&#039;synonyms&#039;, function () {
  return {
    restrict: &#039;E&#039;,
    scope: {
      item: &#039;=&#039;
    },
    template: &#039;&lt;span&gt;{{syn}}&lt;/span&gt;&#039;,
    link: function (scope) {
      scope.syn = angular.isArray(scope.item) ? scope.item.join(&#039;, &#039;) : scope.item;
    }
  };
});

angular.module(&#039;app.ui.aachange&#039;, []).directive(&#039;aaChange&#039;, function () {
  return {
    restrict: &#039;E&#039;,
    scope: {
      items: &#039;=&#039;
    },
    template: &#039;&lt;span&gt;{{set}}&lt;/span&gt;&#039;,
    link: function (scope) {
      var i, aa, symbol, aaMutation;

      symbol = scope.items.fields[&#039;transcript.gene.symbol&#039;];
      aaMutation = scope.items.fields[&#039;transcript.consequence.aa_mutation&#039;];

      if (angular.isArray(symbol)) {
        scope.set = [];
        for (i = 0; i &lt; symbol.length; ++i) {
          aa = symbol[i] + &#039; &#039; + aaMutation[i];
          if (scope.set.indexOf(aa) === -1) {
            scope.set.push(aa);
          }
        }
        scope.set = scope.set.join(&#039;, &#039;);
      } else {
        scope.set = symbol + &#039; &#039; + aaMutation;
      }
    }
  };
});

angular.module(&#039;app.ui.scrollto&#039;, []).directive(&#039;scrollto&#039;, function () {
  return function (scope, elm, attrs) {
    elm.bind(&#039;click&#039;, function (e) {
      var top;

      e.preventDefault();
      if (attrs.href) {
        attrs.scrollto = attrs.href;
      }

      top = jQuery(attrs.scrollto).offset().top - 40;
      jQuery(&#039;body,html&#039;).animate({ scrollTop: top }, 800);
    });
  };
});

angular.module(&#039;app.ui.sortable&#039;, []).directive(&#039;sortable&#039;, function ($location, LocationService) {
  return {
    restrict: &#039;A&#039;,
    scope: {
      active: &#039;@&#039;,
      reversed: &#039;@&#039;,
      field: &#039;@&#039;,
      type: &#039;@&#039;,
      callback: &#039;&amp;&#039;
    },
    transclude: true,
    templateUrl: &#039;template/sortable.html&#039;,
    link: function (scope) {
      var defaultActive, defaultReversed;

      defaultActive = scope.active;
      defaultReversed = scope.reversed;

      scope.$watch(function () {
        return LocationService.getJsonParam(scope.type);
      }, function (so) {
        scope.active = defaultActive;
        scope.reversed = defaultReversed;
        if (so.sort) {
          scope.active = so.sort === scope.field;
          scope.reversed = so.order === &#039;desc&#039;;
        }

        if (angular.isDefined(scope.callback) &amp;&amp; angular.isFunction(scope.callback)) {
          scope.callback();
        }
      }, true);

      scope.onClick = function () {
        var so = LocationService.getJsonParam(scope.type);

        if (so.hasOwnProperty(&#039;sort&#039;) &amp;&amp; so.sort === scope.field) {
          scope.reversed = !scope.reversed;
          so.order = scope.reversed ? &#039;desc&#039; : &#039;asc&#039;;
        } else {
          if (scope.active) {
            scope.reversed = !scope.reversed;
          } else {
            scope.reversed = true;
          }
          so.sort = scope.field;
          so.order = scope.reversed ? &#039;desc&#039; : &#039;asc&#039;;
        }

        // reset to first page
        if (so.from) {
          so.from = 1;
        }

        LocationService.setJsonParam(scope.type, so);
      };
    }
  };
});

angular.module(&#039;app.ui.pagination&#039;, [])

    .constant(&#039;paginationConfig&#039;, {
      boundaryLinks: true,
      directionLinks: true,
      firstText: &#039;&lt;&lt;&lt;&#039;,
      previousText: &#039;&lt;&#039;,
      nextText: &#039;&gt;&#039;,
      lastText: &#039;&gt;&gt;&gt;&#039;,
      maxSize: 5
    })

    .directive(&#039;paginationControls&#039;, function (paginationConfig, LocationService) {
      return {
        restrict: &#039;E&#039;,
        scope: {
          type: &#039;@&#039;,
          data: &#039;=&#039;,
          //maxSize: &#039;=&#039;,
          onSelectPage: &#039;&amp;&#039;
        },
        templateUrl: &#039;template/pagination.html&#039;,
        replace: true,
        link: function (scope, element, attrs) {
          var boundaryLinks, directionLinks, firstText, previousText, nextText, lastText;

          // Setup configuration parameters
          boundaryLinks = angular.isDefined(attrs.boundaryLinks) ?
              scope.$eval(attrs.boundaryLinks) : paginationConfig.boundaryLinks;
          directionLinks = angular.isDefined(attrs.directionLinks) ?
              scope.$eval(attrs.directionLinks) : paginationConfig.directionLinks;
          firstText = angular.isDefined(attrs.firstText) ? attrs.firstText : paginationConfig.firstText;
          previousText = angular.isDefined(attrs.previousText) ? attrs.previousText : paginationConfig.previousText;
          nextText = angular.isDefined(attrs.nextText) ? attrs.nextText : paginationConfig.nextText;
          lastText = angular.isDefined(attrs.lastText) ? attrs.lastText : paginationConfig.lastText;

          scope.maxSize = angular.isDefined(attrs.maxSize) ? attrs.maxSize : paginationConfig.maxSize;

          // Create page object used in template
          function makePage(number, text, isActive, isDisabled) {
            return {
              number: number,
              text: text,
              active: isActive,
              disabled: isDisabled
            };
          }

          scope.$watch(&#039;data.pagination&#039;, function () {
            var max, maxSize, startPage, number, page, previousPage, nextPage, firstPage, lastPage;

            if (!scope.data) {
              return;
            }

            scope.pages = [];

            //set the default maxSize to pages
            maxSize = (scope.maxSize &amp;&amp; scope.maxSize &lt; scope.data.pagination.pages) ?
                scope.maxSize : scope.data.pagination.pages;
            startPage = scope.data.pagination.page - Math.floor(maxSize / 2);

            //adjust the startPage within boundary
            if (startPage &lt; 1) {
              startPage = 1;
            }
            if ((startPage + maxSize - 1) &gt; scope.data.pagination.pages) {
              startPage = startPage - ((startPage + maxSize - 1) - scope.data.pagination.pages);
            }

            // Add page number links
            for (number = startPage, max = startPage + maxSize; number &lt; max; number++) {
              page = makePage(number, number, scope.isActive(number), false);
              scope.pages.push(page);
            }

            // Add previous &amp; next links
            if (directionLinks) {
              previousPage = makePage(scope.data.pagination.page - 1, previousText, false, scope.noPrevious());
              scope.pages.unshift(previousPage);

              nextPage = makePage(scope.data.pagination.page + 1, nextText, false, scope.noNext());
              scope.pages.push(nextPage);
            }

            // Add first &amp; last links
            if (boundaryLinks) {
              firstPage = makePage(1, firstText, false, scope.noPrevious());
              scope.pages.unshift(firstPage);

              lastPage = makePage(scope.data.pagination.pages, lastText, false, scope.noNext());
              scope.pages.push(lastPage);
            }

            if (scope.data.pagination.page &gt; scope.data.pagination.pages) {
              scope.selectPage(scope.data.pagination.pages);
            }
          });
          scope.noPrevious = function () {
            return scope.data.pagination.page === 1;
          };
          scope.noNext = function () {
            return scope.data.pagination.page === scope.data.pagination.pages;
          };
          scope.isActive = function (page) {
            return scope.data.pagination.page === page;
          };

          scope.selectPage = function (page) {
            if (!scope.isActive(page) &amp;&amp; page &gt; 0 &amp;&amp; page &lt;= scope.data.pagination.pages) {
              scope.data.pagination.page = page;
              scope.updateParams(scope.type, page);
              scope.onSelectPage();
            }
          };

          scope.updateParams = function (type, page) {
            var sType, from = (scope.data.pagination.size * (page - 1) + 1);

            if (type) {
              sType = LocationService.getJsonParam(type);
              if (sType) {
                sType.from = from;
                LocationService.setJsonParam(type, sType);
              } else {
                LocationService.setJsonParam(type, &#039;{&quot;from&quot;:&quot;&#039; + from + &#039;&quot;}&#039;);
              }
            } else {
              LocationService.setJsonParam(&#039;from&#039;, from);
            }
          };
        }
      };
    });

angular.module(&#039;app.ui.scrollSpy&#039;, []).directive(&#039;scrollSpy&#039;, function ($window) {
  return {
    restrict: &#039;A&#039;,
    controller: function ($scope) {
      $scope.spies = [];
      this.addSpy = function (spyObj) {
        return $scope.spies.push(spyObj);
      };
    },
    link: function (scope, elem) {
      var spyElems, w;
      spyElems = [];
      w = jQuery($window);

      function scrl() {
        var highlightSpy, pos, spy, _i, _len, _ref;
        highlightSpy = null;
        _ref = scope.spies;
        for (_i = 0, _len = _ref.length; _i &lt; _len; _i++) {
          spy = _ref[_i];
          spy.out();
          if ((pos = spyElems[spy.id].offset().top) - $window.scrollY &lt;= 65) {
            spy.pos = pos;
            if (!highlightSpy) {
              highlightSpy = spy;
            }
            if (highlightSpy.pos &lt; spy.pos) {
              highlightSpy = spy;
            }
          }
        }
        return highlightSpy ? highlightSpy[&#039;in&#039;]() : scope.spies[0][&#039;in&#039;]();
      }

      scope.$watch(&#039;spies&#039;, function (spies) {
        var spy, _i, _len, _results;
        _results = [];
        for (_i = 0, _len = spies.length; _i &lt; _len; _i++) {
          spy = spies[_i];
          if (!spyElems[spy.id]) {
            _results.push(spyElems[spy.id] = elem.find(&#039;#&#039; + spy.id));
          } else {
            _results.push(void 0);
          }
        }
        return _results;
      });

      w.on(&#039;scroll&#039;, scrl);
      scope.$on(&#039;$destroy&#039;, function () {
        w.off(&#039;scroll&#039;, scrl);
      });
    }
  };
})
    .directive(&#039;spy&#039;, function () {
      return {
        restrict: &#039;A&#039;,
        require: &#039;^scrollSpy&#039;,
        link: function (scope, elem, attrs, affix) {
          return affix.addSpy({
            id: attrs.spy,
            &#039;in&#039;: function () {
              return elem.addClass(&#039;current&#039;);
            },
            out: function () {
              return elem.removeClass(&#039;current&#039;);
            }
          });
        }
      };
    });</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ complexity.cyclomatic }} <br>
    Length : {{ complexity.halstead.length }} <br>
    Difficulty : {{ complexity.halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ complexity.halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
